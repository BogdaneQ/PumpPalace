@model PumpPalace.Models.OrderHistoryListViewModel

@{
    ViewData["Title"] = "Order History";
    Layout = "Layout";
}

<h2>Order History</h2>

@if (Model.Orders != null && Model.Orders.Any())
{
    <div class="account-container order-history">
        <table class="table-modern order-history-table">
            <thead>
                <tr>
                    <th>Order ID</th>
                    <th>Order Date</th>
                    <th>Status</th>
                    <th>Total Price</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var order in Model.Orders)
                {
                    <tr>
                        <td>@order.OrderId</td>
                        <td>@order.OrderDate.ToString("yyyy-MM-dd HH:mm")</td>
                        <td>@order.OrderStatus</td>
                        <td>@order.TotalPrice.ToString("C")</td>
                        <td>
                            <div class="action-buttons">
                                <form action="@Url.Action("OrderDetails", "Order", new { orderId = order.OrderId })" method="post" style="display:inline;">
                                    <button type="submit" class="btn btn-primary">Details</button>
                                </form>

                                @if (order.OrderStatus == "Processing")
                                {
                                    <form action="@Url.Action("PaymentPage", "Cart")" method="get" style="display:inline;">
                                        <input type="hidden" name="orderId" value="@order.OrderId" />
                                        <button type="submit" class="btn btn-success">Pay</button>
                                    </form>
                                }
                                else if (order.OrderStatus == "New" || order.OrderStatus == "Paid")
                                {
                                    <form action="@Url.Action("CancelOrder", "Order")" method="post" style="display:inline;">
                                        <input type="hidden" name="orderId" value="@order.OrderId" />
                                        <button type="submit" class="btn btn-danger">Cancel</button>
                                    </form>
                                }
                                else
                                {
                                    <span>N/A</span>
                                }
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <!-- Paginacja -->
        <div class="pagination">

            <!-- Pierwsza strona -->
            @if (Model.CurrentPage > 2)
            {
                <a href="@Url.Action("OrderHistory", "Order", new { page = 1 })" class="page-number">1</a>
                @if (Model.CurrentPage > 3)
                {
                    <span class="page-number dots">...</span>
                }
            }

            <!-- Lewa strona od bieżącej strony -->
            @if (Model.CurrentPage > 1)
            {
                <a href="@Url.Action("OrderHistory", "Order", new { page = Model.CurrentPage - 1 })" class="page-number">@((Model.CurrentPage - 1).ToString())</a>
            }

            <!-- Bieżąca strona -->
            <span class="page-number current">@Model.CurrentPage</span>

            <!-- Prawa strona od bieżącej strony -->
            @if (Model.CurrentPage < Model.TotalPages)
            {
                <a href="@Url.Action("OrderHistory", "Order", new { page = Model.CurrentPage + 1 })" class="page-number">@((Model.CurrentPage + 1).ToString())</a>
            }

            <!-- Ostatnia strona -->
            @if (Model.CurrentPage < Model.TotalPages - 1)
            {
                @if (Model.CurrentPage < Model.TotalPages - 2)
                {
                    <span class="page-number dots">...</span>
                }
                <a href="@Url.Action("OrderHistory", "Order", new { page = Model.TotalPages })" class="page-number">@Model.TotalPages</a>
            }

        </div>

    </div>
}
else
{
    <p>You have no orders in your history.</p>
}